# TradeIQ é¡¹ç›®å®é™…å®ç°è§£è¯»æ–‡æ¡£

> æœ¬æ–‡æ¡£åŸºäºå¯¹é¡¹ç›®å…¨éƒ¨æºä»£ç çš„é€æ–‡ä»¶åˆ†æï¼Œè¯¦ç»†è§£è¯» TradeIQ çš„**å®é™…å®ç°**ï¼ˆéè®¾è®¡ç›®æ ‡ï¼‰ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç†è§£ç³»ç»Ÿæ¶æ„å’Œä»£ç é€»è¾‘ã€‚

---

## ç›®å½•

1. [é¡¹ç›®æ€»è§ˆ](#1-é¡¹ç›®æ€»è§ˆ)
2. [æŠ€æœ¯æ ˆå®å†µ](#2-æŠ€æœ¯æ ˆå®å†µ)
3. [åç«¯æ¶æ„è¯¦è§£](#3-åç«¯æ¶æ„è¯¦è§£)
4. [å‰ç«¯æ¶æ„è¯¦è§£](#4-å‰ç«¯æ¶æ„è¯¦è§£)
5. [AI Agent ç³»ç»Ÿ](#5-ai-agent-ç³»ç»Ÿ)
6. [ä¸‰å¤§ä¸šåŠ¡æ”¯æŸ±](#6-ä¸‰å¤§ä¸šåŠ¡æ”¯æŸ±)
7. [å®æ—¶é€šä¿¡ç³»ç»Ÿ](#7-å®æ—¶é€šä¿¡ç³»ç»Ÿ)
8. [è®¤è¯ä¸å®‰å…¨](#8-è®¤è¯ä¸å®‰å…¨)
9. [æ¼”ç¤ºç³»ç»Ÿ](#9-æ¼”ç¤ºç³»ç»Ÿ)
10. [æ•°æ®æµå…¨é“¾è·¯](#10-æ•°æ®æµå…¨é“¾è·¯)
11. [ç›®å½•ç»“æ„é€ŸæŸ¥](#11-ç›®å½•ç»“æ„é€ŸæŸ¥)
12. [API æ¥å£æ¸…å•](#12-api-æ¥å£æ¸…å•)
13. [ç¯å¢ƒå˜é‡æ¸…å•](#13-ç¯å¢ƒå˜é‡æ¸…å•)
14. [ç°æœ‰ä¸è¶³ä¸æ”¹è¿›æ–¹å‘](#14-ç°æœ‰ä¸è¶³ä¸æ”¹è¿›æ–¹å‘)

---

## 1. é¡¹ç›®æ€»è§ˆ

### 1.1 é¡¹ç›®å®šä½

TradeIQ æ˜¯ Deriv AI Hackathon 2026 å‚èµ›é¡¹ç›®ï¼Œä¸»é¢˜ä¸º **"Intelligent Trading Analyst"**ï¼ˆæ™ºèƒ½äº¤æ˜“åˆ†æå¸ˆï¼‰ã€‚

é¡¹ç›®å£å·ï¼š**"æ•£æˆ·çš„å½­åšç»ˆç«¯ã€ä»æœªæ‹¥æœ‰è¿‡çš„äº¤æ˜“æ•™ç»ƒã€ä¸€ç›´æƒ³è¦çš„å†…å®¹å›¢é˜Ÿ"**ã€‚

### 1.2 ä¸‰å¤§æ ¸å¿ƒæ”¯æŸ±

| æ”¯æŸ± | åŠŸèƒ½ | å…³é”®çº¦æŸ |
|------|------|---------|
| **å¸‚åœºåˆ†æ** (Market Analysis) | å®æ—¶è¡Œæƒ…ã€æŠ€æœ¯æŒ‡æ ‡ã€æƒ…ç»ªåˆ†æã€AI é—®ç­” | ä¸åšé¢„æµ‹/ä¿¡å· |
| **è¡Œä¸ºæ•™ç»ƒ** (Behavioral Coaching) | äº¤æ˜“æ¨¡å¼æ£€æµ‹ã€æƒ…ç»ªè¯†åˆ«ã€æ”¯æŒæ€§æé†’ | æ”¯æŒè€Œéé™åˆ¶ |
| **ç¤¾äº¤å†…å®¹** (Content Engine) | AI ç”Ÿæˆç¤¾äº¤å¸–å­ã€å¤šäººæ ¼ã€Bluesky å‘å¸ƒ | å“ç‰Œå®‰å…¨ã€åˆè§„ |

### 1.3 è¯„åˆ¤æ ‡å‡†å¯¹é½

- **æ´å¯ŸåŠ› (30%)**ï¼šå¤šæ•°æ®æºèåˆåˆ†æ + è¡Œä¸ºæ¨¡å¼æ£€æµ‹
- **å®ç”¨æ€§ (25%)**ï¼šæ¯æ—¥ç®€æŠ¥ã€å®æ—¶è§£é‡Šã€æ¸©å’Œæé†’
- **å·¥è‰º (20%)**ï¼šNext.js ç°ä»£ UIã€å¯¹è¯å¼ AIã€WebSocket å®æ—¶æ›´æ–°
- **é‡å¿ƒ (15%)**ï¼šä¸‰ä¸ª AI Agent ååŒå·¥ä½œ
- **æ¼”ç¤º (10%)**ï¼šå››å¹•å¼æ•…äº‹ç»“æ„

---

## 2. æŠ€æœ¯æ ˆå®å†µ

> **æ³¨æ„**ï¼šå®é™…æŠ€æœ¯æ ˆä¸æœ€åˆè®¾è®¡æ–‡æ¡£æœ‰å·®å¼‚ï¼ˆè®¾è®¡æ–‡æ¡£å†™çš„æ˜¯ FastAPI + LangGraphï¼Œå®é™…é‡‡ç”¨ Django + åŸç”Ÿå‡½æ•°è°ƒç”¨ï¼‰ã€‚

### å®é™…ä½¿ç”¨

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **å‰ç«¯æ¡†æ¶** | Next.js 16 + React 19 | App Router æ¨¡å¼ |
| **UI ç»„ä»¶** | çº¯ Tailwind CSS v4 æ‰‹å†™ç»„ä»¶ | é shadcn/uiï¼ˆè®¾è®¡æ–‡æ¡£å†™äº†ä½†æœªä½¿ç”¨ï¼‰ |
| **å›¾è¡¨** | Recharts + lightweight-charts | Recharts ä¸ºä¸»ï¼ŒTradingView å·²å®‰è£…ä½†æœªä½¿ç”¨ |
| **åŠ¨ç”»** | Framer Motion | é¡µé¢è¿‡æ¸¡å’Œäº¤äº’åŠ¨ç”» |
| **å›¾æ ‡** | Lucide React | å…¨å¥—çº¿æ€§å›¾æ ‡ |
| **åç«¯æ¡†æ¶** | Django 5 + DRF + Channels | é FastAPI |
| **AI å¼•æ“** | DeepSeek-V3.2 (é€šè¿‡ OpenRouter) | é Claude APIï¼ˆè®¾è®¡æ–‡æ¡£å†™äº†ä½†æœªä½¿ç”¨ï¼‰ |
| **AI ç¼–æ’** | åŸç”Ÿå‡½æ•°è°ƒç”¨ (Function Calling) | é LangGraph |
| **æ•°æ®åº“** | Supabase PostgreSQL | é€šè¿‡ dj-database-url è¿æ¥ |
| **å®æ—¶é€šä¿¡** | Django Channels (WebSocket) | InMemory Channel Layer |
| **ç¤¾äº¤å¹³å°** | Bluesky (AT Protocol) | atproto åº“ |
| **æ–°é—»æ•°æ®** | NewsAPI + Finnhub | åŒæ•°æ®æºèšåˆ |
| **è¡Œæƒ…æ•°æ®** | Deriv WebSocket API | app_id=125489 |

---

## 3. åç«¯æ¶æ„è¯¦è§£

### 3.1 Django é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ tradeiq/                # Django ä¸»é…ç½®
â”‚   â”œâ”€â”€ settings.py         # å…¨å±€è®¾ç½®ï¼ˆDBã€CORSã€Authã€Channelsï¼‰
â”‚   â”œâ”€â”€ urls.py             # æ ¹è·¯ç”±ï¼ˆ6 ä¸ª API æ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ asgi.py             # WebSocket å…¥å£ï¼ˆChannelsï¼‰
â”‚   â”œâ”€â”€ celery.py           # Celery ä»»åŠ¡é˜Ÿåˆ—é…ç½®ï¼ˆå·²é…ç½®ä½†æœªå¤§é‡ä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ auth_utils.py       # Supabase JWT â†’ UserProfile æ˜ å°„
â”‚   â”œâ”€â”€ permissions.py      # è‡ªå®šä¹‰ DRF æƒé™ç±»
â”‚   â”œâ”€â”€ exceptions.py       # å…¨å±€å¼‚å¸¸å¤„ç†
â”‚   â””â”€â”€ middleware/
â”‚       â””â”€â”€ supabase_auth.py  # Supabase JWT è®¤è¯ä¸­é—´ä»¶
â”‚
â”œâ”€â”€ agents/                 # AI Agent ç¼–æ’å±‚
â”œâ”€â”€ market/                 # å¸‚åœºåˆ†ææ¨¡å—
â”œâ”€â”€ behavior/               # è¡Œä¸ºæ£€æµ‹æ¨¡å—
â”œâ”€â”€ content/                # å†…å®¹ç”Ÿæˆæ¨¡å—
â”œâ”€â”€ chat/                   # WebSocket èŠå¤©
â”œâ”€â”€ demo/                   # æ¼”ç¤ºåœºæ™¯ç®¡ç†
â””â”€â”€ manage.py
```

### 3.2 å…­å¤§ä¸šåŠ¡æ¨¡å—

æ¯ä¸ªæ¨¡å—éµå¾ª Django æ ‡å‡†ç»“æ„ï¼š`models.py` â†’ `serializers.py` â†’ `views.py` â†’ `urls.py` â†’ `tools.py`ã€‚

å…¶ä¸­ `tools.py` æ˜¯æœ¬é¡¹ç›®ç‰¹è‰²â€”â€”æ¯ä¸ªæ¨¡å—æä¾›å¯è¢« AI Agent è°ƒç”¨çš„å·¥å…·å‡½æ•°ã€‚

---

## 4. å‰ç«¯æ¶æ„è¯¦è§£

### 4.1 é¡µé¢ç»“æ„ (App Router)

```
src/app/
â”œâ”€â”€ page.tsx              # ä»ªè¡¨ç›˜ä¸»é¡µ
â”œâ”€â”€ market/page.tsx       # å¸‚åœºåˆ†æé¡µ
â”œâ”€â”€ behavior/page.tsx     # è¡Œä¸ºæ•™ç»ƒé¡µ
â”œâ”€â”€ content/page.tsx      # å†…å®¹å¼•æ“é¡µ
â”œâ”€â”€ pipeline/page.tsx     # Agent ç®¡é“é¡µï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ login/page.tsx        # ç™»å½•é¡µ
â””â”€â”€ auth/callback/page.tsx  # OAuth å›è°ƒé¡µ
```

### 4.2 ç»„ä»¶æ¶æ„

```
src/components/
â”œâ”€â”€ layout/
â”‚   â”œâ”€â”€ AppShell.tsx       # å…¨å±€å£³ï¼ˆNavbar + TickerBar + Sidebarï¼‰
â”‚   â”œâ”€â”€ Navbar.tsx         # é¡¶éƒ¨å¯¼èˆªï¼ˆLogoã€5 ä¸ªé¡µé¢é“¾æ¥ã€ç™»å½•æŒ‰é’®ï¼‰
â”‚   â”œâ”€â”€ Sidebar.tsx        # å³ä¾§é¢æ¿ï¼ˆAI Chat + Activity ä¸¤ä¸ª Tabï¼‰
â”‚   â””â”€â”€ TickerBar.tsx      # è¡Œæƒ…æ»šåŠ¨æ¡ï¼ˆ30s å¾ªç¯æ»šåŠ¨ï¼Œ10s è½®è¯¢æ›´æ–°ï¼‰
â”‚
â”œâ”€â”€ market/
â”‚   â”œâ”€â”€ PnLChart.tsx       # Recharts é¢ç§¯å›¾ï¼ˆPnL / è¡Œæƒ…åŒç”¨é€”ï¼‰
â”‚   â””â”€â”€ MarketOverview.tsx # å¸‚åœºæ€»è§ˆè¡¨æ ¼ï¼ˆ12 åˆ—ç½‘æ ¼ï¼‰
â”‚
â”œâ”€â”€ behavior/
â”‚   â””â”€â”€ BehaviorCard.tsx   # è¡Œä¸ºæ¨¡å¼å¡ç‰‡ï¼ˆä¸¥é‡åº¦æŒ‡ç¤º + AI å»ºè®®æŠ˜å ï¼‰
â”‚
â”œâ”€â”€ content/
â”‚   â””â”€â”€ ContentWorkbench.tsx  # å†…å®¹å·¥ä½œå°ï¼ˆç”Ÿæˆ â†’ é¢„è§ˆ â†’ å‘å¸ƒå…¨æµç¨‹ï¼‰
â”‚
â”œâ”€â”€ chat/
â”‚   â”œâ”€â”€ ChatPanel.tsx      # èŠå¤©é¢æ¿ï¼ˆæ¶ˆæ¯åˆ—è¡¨ + è¾“å…¥æ¡†ï¼‰
â”‚   â””â”€â”€ ChatMessage.tsx    # æ¶ˆæ¯æ°”æ³¡ï¼ˆåŒºåˆ†ç”¨æˆ·/AI/æé†’/å…è´£ï¼‰
â”‚
â””â”€â”€ ui/                    # é€šç”¨ UI ç»„ä»¶
    â”œâ”€â”€ DataCard.tsx       # æ•°æ®å¡ç‰‡ï¼ˆæ ‡é¢˜ã€æ•°å€¼ã€è¶‹åŠ¿ç®­å¤´ã€å‘å…‰æ•ˆæœï¼‰
    â”œâ”€â”€ StatusBadge.tsx    # çŠ¶æ€æ ‡ç­¾ï¼ˆ5 ç§é¢œè‰² + è„‰å†²åŠ¨ç”»ï¼‰
    â”œâ”€â”€ DisclaimerBadge.tsx  # å…è´£å£°æ˜ï¼ˆ3 ç§å˜ä½“ï¼šå†…è”/æ¨ªå¹…/é¡µè„šï¼‰
    â”œâ”€â”€ DataSourceBadge.tsx  # æ•°æ®æºæ ‡ç­¾ï¼ˆLIVE ç»¿ / FALLBACK æ©™ï¼‰
    â”œâ”€â”€ CollapsibleSection.tsx  # å¯æŠ˜å åŒºå—
    â””â”€â”€ LoadingDots.tsx    # åŠ è½½åŠ¨ç”»ï¼ˆ3 ä¸ªè·³åŠ¨åœ†ç‚¹ï¼‰
```

### 4.3 è‡ªå®šä¹‰ Hooks ä½“ç³»

é¡¹ç›®çš„æ ¸å¿ƒè®¾è®¡æ¨¡å¼æ˜¯ **`useApiWithFallback`** â€”â€” æ‰€æœ‰æ•°æ®è·å–éƒ½ç»è¿‡è¿™ä¸ª Hookï¼Œè‡ªåŠ¨å¤„ç†åŠ è½½ã€é”™è¯¯ã€å›é€€æ•°æ®ã€è½®è¯¢ã€‚

```
useApiWithFallback<T>
â”œâ”€â”€ data: T              // å®é™…æ•°æ®ï¼ˆçœŸå®æˆ–å›é€€ï¼‰
â”œâ”€â”€ isLoading: boolean   // åŠ è½½çŠ¶æ€
â”œâ”€â”€ error: string | null // é”™è¯¯ä¿¡æ¯
â”œâ”€â”€ isUsingMock: boolean // æ˜¯å¦ä½¿ç”¨å›é€€æ•°æ®
â”œâ”€â”€ refetch()            // æ‰‹åŠ¨åˆ·æ–°
â””â”€â”€ isBackendOnline      // åç«¯æ˜¯å¦åœ¨çº¿
```

**å„é¡µé¢ Hooksï¼š**

| Hook | åŠŸèƒ½ |
|------|------|
| `useTickerData()` | è¡Œæƒ…æ»šåŠ¨æ¡æ•°æ®ï¼Œå®æ—¶ä»·æ ¼ + æ¶¨è·Œå¹… |
| `useMarketOverview()` | å¸‚åœºç®€æŠ¥ + å·¥å…·åˆ—è¡¨ |
| `useMarketInsights()` | AI æ´å¯ŸåŠ¨æ€æµ |
| `useTrades()` | äº¤æ˜“è®°å½•æ ¼å¼åŒ– |
| `useBehaviorPatterns()` | è¡Œä¸ºæ¨¡å¼æ‰¹é‡åˆ†æ |
| `useSessionStats()` | äº¤æ˜“ä¼šè¯ç»Ÿè®¡ï¼ˆèƒœç‡ã€é£é™©ç­‰çº§ï¼‰ |
| `usePersonas()` | AI äººæ ¼åˆ—è¡¨ + äº’åŠ¨æ•°æ® |
| `usePosts()` | ç¤¾äº¤å¸–å­ç®¡ç† |
| `useDashboardMetrics()` | ä»ªè¡¨ç›˜æŒ‡æ ‡ï¼ˆç»„åˆä»·å€¼ã€æ—¥ PnLã€é£é™©åˆ†ï¼‰ |
| `useBackendHealth()` | åç«¯å¥åº·æ£€æµ‹ï¼ˆ3s è¶…æ—¶ï¼‰ |

### 4.4 API å®¢æˆ·ç«¯ (`src/lib/api.ts`)

ç»Ÿä¸€çš„ `ApiClient` ç±»ï¼Œå°è£…äº†çº¦ **25+ ä¸ª API æ–¹æ³•**å’Œ **60+ ä¸ª TypeScript æ¥å£**ã€‚

```typescript
class ApiClient {
  request<T>(path, options?)    // é€šç”¨è¯·æ±‚ï¼Œæ”¯æŒ Bearer Token

  // å¸‚åœºåˆ†æ
  getMarketBrief(instruments?)  // å¸‚åœºç®€æŠ¥
  askMarketAnalyst(question)    // AI åˆ†æå¸ˆé—®ç­”
  getLivePrice(instrument)      // å®æ—¶è¡Œæƒ…
  getMarketHistory(...)         // K çº¿æ•°æ®
  getMarketTechnicals(...)      // æŠ€æœ¯æŒ‡æ ‡
  getMarketSentiment(...)       // æƒ…ç»ªåˆ†æ

  // è¡Œä¸ºæ•™ç»ƒ
  getTrades(userId?)            // äº¤æ˜“å†å²
  analyzeBatch(userId, hours)   // æ‰¹é‡è¡Œä¸ºåˆ†æ

  // å†…å®¹å¼•æ“
  generateContent(data)         // ç”Ÿæˆå†…å®¹
  publishToBluesky(content)     // å‘å¸ƒåˆ° Bluesky

  // Agent ç®¡é“
  runPipeline(params)           // å®Œæ•´ 4 é˜¶æ®µç®¡é“
  runMonitor / runAnalyst / runAdvisor / runContentGen  // å•æ­¥æ‰§è¡Œ

  // æ¼”ç¤º
  loadScenario(scenario)        // åŠ è½½æ¼”ç¤ºåœºæ™¯
  analyzeScenario(scenario)     // åˆ†ææ¼”ç¤ºåœºæ™¯
}
```

### 4.5 è§†è§‰è®¾è®¡

**ä¸»é¢˜**ï¼šå…¨æš—è‰²ï¼ˆ#000000 èƒŒæ™¯ï¼‰ï¼Œé‡‘èç»ˆç«¯é£æ ¼

**é…è‰²æ–¹æ¡ˆ**ï¼š
- ç›ˆåˆ©è‰²ï¼š`#4ade80` (ç»¿)ï¼Œå¸¦ç»¿è‰²è¾‰å…‰
- äºæŸè‰²ï¼š`#f87171` (çº¢)ï¼Œå¸¦çº¢è‰²è¾‰å…‰
- å¼ºè°ƒè‰²ï¼š`#3b82f6` (è“)
- è­¦å‘Šè‰²ï¼š`#fbbf24` (é»„)
- è¾…åŠ©è‰²ï¼š`#22d3ee` (é’)

**å­—ä½“**ï¼š
- æ•°æ®æ˜¾ç¤ºï¼šJetBrains Monoï¼ˆç­‰å®½å­—ä½“ï¼‰
- æ­£æ–‡ï¼šInter

**ç‰¹æ•ˆ**ï¼š
- æ¯›ç»ç’ƒæ•ˆæœ (backdrop-blur)
- æ¸å˜è¾¹æ¡†
- è„‰å†²åŠ¨ç”»ï¼ˆå®æ—¶æŒ‡ç¤ºå™¨ï¼‰
- è¡Œæƒ…æ»šåŠ¨æ¡ï¼ˆCSS åŠ¨ç”»ï¼‰
- æ•°æ®å¡ç‰‡æ‚¬åœæ•ˆæœ

---

## 5. AI Agent ç³»ç»Ÿ

### 5.1 æ¶æ„æ¦‚è¿°

ç³»ç»Ÿä¸ä½¿ç”¨ LangGraph æˆ–å…¶ä»–æ¡†æ¶ï¼Œè€Œæ˜¯åŸºäº **DeepSeek åŸç”Ÿå‡½æ•°è°ƒç”¨ (Function Calling)** å®ç° Agent è·¯ç”±ã€‚

```
ç”¨æˆ·è¾“å…¥ â†’ Routerï¼ˆè‡ªåŠ¨æ£€æµ‹ Agent ç±»å‹ï¼‰
         â†’ åŠ è½½å¯¹åº”ç³»ç»Ÿæç¤ºè¯ + å·¥å…·é›†
         â†’ å‘é€ç»™ DeepSeek (æ”¯æŒ Function Calling)
         â†’ DeepSeek å†³å®šè°ƒç”¨å“ªäº›å·¥å…·
         â†’ æ‰§è¡Œå·¥å…·ï¼Œå°†ç»“æœå›ä¼ ç»™ DeepSeek
         â†’ DeepSeek ç”Ÿæˆæœ€ç»ˆå›å¤
         â†’ åˆè§„è¿‡æ»¤ï¼ˆæ•æ„Ÿè¯æ£€æµ‹ï¼‰
         â†’ æ·»åŠ å…è´£å£°æ˜
         â†’ è¿”å›ç»™ç”¨æˆ·
```

### 5.2 æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| `agents/router.py` | æŸ¥è¯¢è·¯ç”±å™¨ï¼šæ¥æ”¶ç”¨æˆ·è¾“å…¥ â†’ é€‰æ‹©å·¥å…· â†’ è°ƒ LLM â†’ æ‰§è¡Œå·¥å…· â†’ åˆè§„è¿‡æ»¤ |
| `agents/llm_client.py` | ç»Ÿä¸€ LLM å®¢æˆ·ç«¯ï¼šä¼˜å…ˆ OpenRouterï¼Œå›é€€åˆ°ç›´è¿ DeepSeek API |
| `agents/tools_registry.py` | å·¥å…·æ³¨å†Œè¡¨ï¼šå®šä¹‰å„ Agent å¯ç”¨å·¥å…·åŠå…¶ JSON Schema |
| `agents/prompts.py` | ç³»ç»Ÿæç¤ºè¯ï¼šæ¯ä¸ª Agent çš„è§’è‰²å®šä¹‰å’Œåˆè§„è§„åˆ™ |
| `agents/compliance.py` | åˆè§„è¿‡æ»¤å™¨ï¼šæ•æ„Ÿè¯é»‘åå• + é¢„æµ‹è¯æ£€æµ‹ + å…è´£å£°æ˜æ³¨å…¥ |
| `agents/agent_team.py` | å››é˜¶æ®µç®¡é“ï¼šMonitor â†’ Analyst â†’ Advisor â†’ Creator |

### 5.3 å››é˜¶æ®µç®¡é“ (Agent Team Pipeline)

```
é˜¶æ®µ 1ï¼šå¸‚åœºç›‘æ§ (Market Monitor)
  è¾“å…¥ï¼šinstruments åˆ—è¡¨, event æè¿°
  è¾“å‡ºï¼šMonitorOutputï¼ˆevents åˆ—è¡¨ã€top_eventã€severityï¼‰
  å·¥å…·ï¼šfetch_price_data, search_news

    â†“

é˜¶æ®µ 2ï¼šåˆ†æå¸ˆ (Analyst)
  è¾“å…¥ï¼šMonitorOutput
  è¾“å‡ºï¼šAnalysisReportï¼ˆroot_causes, impact_assessment, key_levelsï¼‰
  å·¥å…·ï¼šanalyze_technicals, get_sentiment, search_news

    â†“

é˜¶æ®µ 3ï¼šæŠ•èµ„é¡¾é—® (Portfolio Advisor)
  è¾“å…¥ï¼šAnalysisReport + ç”¨æˆ·æŠ•èµ„ç»„åˆ
  è¾“å‡ºï¼šPersonalizedInsightï¼ˆpersonalized_analysis, action_items, risk_assessmentï¼‰
  å·¥å…·ï¼šget_recent_trades, get_trading_statistics

    â†“

é˜¶æ®µ 4ï¼šå†…å®¹åˆ›ä½œ (Content Creator)
  è¾“å…¥ï¼šAnalysisReport + PersonalizedInsight
  è¾“å‡ºï¼šMarketCommentaryï¼ˆbluesky_post, thread, hashtagsï¼‰
  å·¥å…·ï¼šgenerate_draft, generate_thread
```

æ¯ä¸ªé˜¶æ®µä½¿ç”¨ Python `dataclass` å®šä¹‰è¾“å…¥è¾“å‡ºå¥‘çº¦ï¼Œé˜¶æ®µé—´é€šè¿‡æ•°æ®ä¼ é€’è¿æ¥ã€‚ä»»ä¸€é˜¶æ®µå¤±è´¥ä¸ä¼šä¸­æ–­æ•´ä¸ªç®¡é“ï¼Œè€Œæ˜¯æ ‡è®°ä¸º `partial`ï¼ˆéƒ¨åˆ†æˆåŠŸï¼‰ã€‚

### 5.4 å·¥å…·æ³¨å†Œè¡¨

**å¸‚åœºåˆ†æå·¥å…·**ï¼š
- `fetch_price_data(instrument)` â€” Deriv WebSocket å®æ—¶ä»·æ ¼
- `fetch_price_history(instrument, timeframe, count)` â€” K çº¿æ•°æ®
- `search_news(query, limit)` â€” NewsAPI + Finnhub æ–°é—»
- `analyze_technicals(instrument, timeframe)` â€” SMAã€RSIã€è¶‹åŠ¿ã€æ³¢åŠ¨ç‡
- `get_sentiment(instrument)` â€” LLM æƒ…ç»ªåˆ†æ
- `explain_market_move(instrument, move)` â€” è¡Œæƒ…å¼‚åŠ¨è§£é‡Š
- `generate_market_brief(instruments)` â€” å¤šå“ç§ç®€æŠ¥

**è¡Œä¸ºåˆ†æå·¥å…·**ï¼š
- `get_recent_trades(user_id, hours)` â€” æœ€è¿‘äº¤æ˜“è®°å½•
- `analyze_trade_patterns(user_id, hours)` â€” è¡Œä¸ºæ¨¡å¼æ£€æµ‹
- `generate_behavioral_nudge_with_ai(user_id, analysis)` â€” AI ç”Ÿæˆæé†’
- `get_trading_statistics(user_id, days)` â€” äº¤æ˜“ç»Ÿè®¡
- `save_behavioral_metric(user_id, date, data)` â€” ä¿å­˜æ—¥åº¦æŒ‡æ ‡

**å†…å®¹ç”Ÿæˆå·¥å…·**ï¼š
- `generate_draft(persona_id, topic, platform, max_length)` â€” å•æ¡å¸–å­
- `generate_thread(persona_id, topic, num_posts, platform)` â€” å¸–å­çº¿ç¨‹
- `format_for_platform(content, platform)` â€” å¹³å°é€‚é…ï¼ˆå­—æ•°é™åˆ¶ï¼‰

### 5.5 åˆè§„ç³»ç»Ÿ

è¿™æ˜¯é¡¹ç›®çš„å…³é”®ç‰¹è‰²â€”â€”æ‰€æœ‰ AI è¾“å‡ºå¿…é¡»ç»è¿‡åˆè§„è¿‡æ»¤ï¼š

**é»‘åå•è¯æ±‡**ï¼š`guaranteed`ã€`moon`ã€`easy money`ã€`get rich`ã€`sure thing`

**é¢„æµ‹è¯æ£€æµ‹**ï¼š`will hit`ã€`price will`ã€`going to`

**å…è´£å£°æ˜**ï¼šæ¯æ¡è¾“å‡ºè‡ªåŠ¨è¿½åŠ  `ğŸ“Š Analysis by TradeIQ | Not financial advice`

---

## 6. ä¸‰å¤§ä¸šåŠ¡æ”¯æŸ±

### 6.1 å¸‚åœºåˆ†æ (Market Module)

**æ•°æ®æ¨¡å‹**ï¼š
- `MarketInsight` â€” å­˜å‚¨ AI ç”Ÿæˆçš„å¸‚åœºæ´å¯Ÿï¼ˆå“ç§ã€æƒ…ç»ªåˆ†æ•°ã€æ•°æ®æºï¼‰

**æ•°æ®æºæ¥å…¥**ï¼š
```
Deriv WebSocket API (wss://ws.derivws.com/websockets/v3)
â”œâ”€â”€ å®æ—¶æŠ¥ä»·ï¼ˆtick æ•°æ®ï¼‰
â”œâ”€â”€ å†å² K çº¿ï¼ˆOHLC candlesï¼‰
â””â”€â”€ æ”¯æŒå“ç§ï¼šå¤–æ±‡ (frxEURUSD)ã€åŠ å¯†è´§å¸ (cryBTCUSD)ã€æ³¢åŠ¨ç‡æŒ‡æ•° (R_75, R_100)

NewsAPI + Finnhub
â”œâ”€â”€ å…³é”®è¯æœç´¢æ–°é—»
â”œâ”€â”€ åŒæºèšåˆå»é‡
â””â”€â”€ ç”¨äºæƒ…ç»ªåˆ†æè¾“å…¥
```

**æŠ€æœ¯åˆ†æå®ç°** (`market/tools.py: analyze_technicals`)ï¼š
- SMA(20) å’Œ SMA(50) â€” ç®€å•ç§»åŠ¨å¹³å‡çº¿
- RSI(14) â€” ç›¸å¯¹å¼ºå¼±æŒ‡æ ‡
- æ³¢åŠ¨ç‡ â€” æ”¶ç›Šç‡æ ‡å‡†å·®
- æ”¯æ’‘/é˜»åŠ›ä½ â€” 20 æ ¹ K çº¿çš„é«˜ä½ç‚¹
- è¶‹åŠ¿åˆ¤æ–­ â€” çœ‹æ¶¨/çœ‹è·Œ/ä¸­æ€§

**å‰ç«¯å‘ˆç°**ï¼š
- å“ç§é€‰æ‹©å™¨ï¼ˆ8+ äº¤æ˜“å¯¹ï¼‰
- Recharts é¢ç§¯å›¾ï¼ˆå®æ—¶è¡Œæƒ…ï¼‰
- æŠ€æœ¯æŒ‡æ ‡é¢æ¿ï¼ˆRSIã€SMAã€æ”¯æ’‘é˜»åŠ›ï¼‰
- æƒ…ç»ªä»ªè¡¨ç›˜ï¼ˆå¤šç©ºè¯„åˆ† -1.0 åˆ° 1.0ï¼‰
- AI åˆ†æå¸ˆé—®ç­”ï¼ˆæ¨èé—®é¢˜åˆ—è¡¨ï¼‰

### 6.2 è¡Œä¸ºæ•™ç»ƒ (Behavior Module)

**æ•°æ®æ¨¡å‹**ï¼š
- `UserProfile` â€” ç”¨æˆ·ç”»åƒï¼ˆé‚®ç®±ã€åå¥½ã€å…³æ³¨åˆ—è¡¨ï¼‰
- `Trade` â€” å•ç¬”äº¤æ˜“ï¼ˆå“ç§ã€ç›ˆäºã€æŒç»­æ—¶é—´ã€`is_mock` æ ‡è®°ï¼‰
- `BehavioralMetric` â€” æ—¥åº¦èšåˆæŒ‡æ ‡ï¼ˆèƒœç‡ã€æ¨¡å¼æ ‡è®°ã€æƒ…ç»ªçŠ¶æ€ï¼‰

**å››å¤§æ£€æµ‹ç®—æ³•** (`behavior/detection.py`)ï¼š

#### 1. æŠ¥å¤æ€§äº¤æ˜“ (Revenge Trading)
```
è§¦å‘æ¡ä»¶ï¼šäºæŸå 10 åˆ†é’Ÿå†…è¿ç»­ â‰¥3 ç¬”äº¤æ˜“
ä¸¥é‡åº¦ï¼š
  - low: 3 ç¬”
  - medium: 4 ç¬”
  - high: â‰¥5 ç¬”
è¾“å‡ºï¼štrade_count, time_window, trigger_loss
```

#### 2. è¿‡åº¦äº¤æ˜“ (Overtrading)
```
è§¦å‘æ¡ä»¶ï¼šå½“æ—¥äº¤æ˜“ç¬”æ•° > æ—¥å‡ Ã— 2
ä¸¥é‡åº¦ï¼š
  - low: 2-2.5 å€
  - medium: 2.5-3 å€
  - high: >3 å€
è¾“å‡ºï¼štoday_count, average, ratio
```

#### 3. è¿½æŸäº¤æ˜“ (Loss Chasing)
```
è§¦å‘æ¡ä»¶ï¼šè¿ç»­ â‰¥2 ç¬”äºæŸ + ä»“ä½å¢åŠ  â‰¥20%
ä¸¥é‡åº¦ï¼šæŒ‰è¿ç»­äºæŸæ¬¡æ•°å’ŒåŠ ä»“æ¯”ä¾‹è®¡ç®—
è¾“å‡ºï¼šconsecutive_losses, size_increase_pct
```

#### 4. æ—¶æ®µæ¨¡å¼ (Time-Based Patterns)
```
è§¦å‘æ¡ä»¶ï¼šæŸæ—¶æ®µèƒœç‡ < 35%ï¼ˆè‡³å°‘ 3 ç¬”äº¤æ˜“ï¼‰
ä¸¥é‡åº¦ï¼šæ ¹æ®èƒœç‡é«˜ä½
è¾“å‡ºï¼šworst_hours, win_rate_by_hour
```

**å®æ—¶æé†’æœºåˆ¶**ï¼š
```
åˆ›å»ºäº¤æ˜“ â†’ TradeViewSet.create()
         â†’ analyze_trade_patterns() ï¼ˆåˆ†æè¿‡å» 24 å°æ—¶ï¼‰
         â†’ æ£€æµ‹å››ç§æ¨¡å¼
         â†’ if needs_nudge:
              generate_behavioral_nudge_with_ai()  // DeepSeek ç”Ÿæˆæé†’
              â†’ WebSocket æ¨é€åˆ° chat_user_{user_id} ç¾¤ç»„
         â†’ ä¿å­˜ BehavioralMetric
```

**æé†’è¯­æ°”**ï¼šæ”¯æŒæ€§è€Œéæƒ©ç½šæ€§ï¼ˆ"æˆ‘æ³¨æ„åˆ°..."ï¼Œè€Œé"ä½ åœ¨çŠ¯é”™..."ï¼‰

### 6.3 ç¤¾äº¤å†…å®¹å¼•æ“ (Content Module)

**æ•°æ®æ¨¡å‹**ï¼š
- `AIPersona` â€” AI äººæ ¼ï¼ˆå†·é™åˆ†æå¸ˆã€æ•°æ®æå®¢ç­‰ï¼‰ï¼Œå«æ€§æ ¼æè¿°å’Œç³»ç»Ÿæç¤ºè¯
- `SocialPost` â€” ç”Ÿæˆçš„å¸–å­ï¼ˆå¹³å°ã€çŠ¶æ€ï¼šè‰ç¨¿/å·²å‘å¸ƒã€äº’åŠ¨æ•°æ®ï¼‰

**ç”Ÿæˆæµç¨‹**ï¼š
```
ç”¨æˆ·è¾“å…¥æ´å¯Ÿ â†’ é€‰æ‹©å¹³å°ï¼ˆBluesky å•å¸– / çº¿ç¨‹ï¼‰
            â†’ é€‰æ‹© AI äººæ ¼
            â†’ DeepSeek ç”Ÿæˆå†…å®¹ï¼ˆå—äººæ ¼é£æ ¼çº¦æŸï¼‰
            â†’ åˆè§„æ£€æŸ¥ï¼ˆæ•æ„Ÿè¯è¿‡æ»¤ + å…è´£å£°æ˜ï¼‰
            â†’ å­—æ•°é€‚é…ï¼ˆBluesky é™ 300 å­—ç¬¦ï¼‰
            â†’ é¢„è§ˆå¡ç‰‡
            â†’ å‘å¸ƒåˆ° Blueskyï¼ˆå¯é€‰ï¼‰
```

**Bluesky å‘å¸ƒ** (`content/bluesky.py`)ï¼š
- ä½¿ç”¨ `atproto` åº“å®ç° AT Protocol
- æ”¯æŒå•æ¡å‘å¸ƒå’Œçº¿ç¨‹å‘å¸ƒ
- AT URI è½¬æ¢ä¸º Web URL
- å‘å¸ƒç»“æœåé¦ˆï¼ˆåŒ…å«é“¾æ¥ï¼‰

**ContentWorkbench ç»„ä»¶**ï¼ˆå‰ç«¯æ ¸å¿ƒï¼‰ï¼š
- è¾“å…¥åŒºï¼šå¸‚åœºæ´å¯Ÿæ–‡æœ¬
- é€‰æ‹©åŒºï¼šå¹³å° + äººæ ¼
- é¢„è§ˆåŒºï¼šBluesky å¡ç‰‡æ ·å¼é¢„è§ˆ + å­—æ•°è®¡æ•°å™¨
- æ“ä½œåŒºï¼šå¤åˆ¶ + å‘å¸ƒæŒ‰é’®

---

## 7. å®æ—¶é€šä¿¡ç³»ç»Ÿ

### 7.1 åç«¯ WebSocket (Django Channels)

**ASGI é…ç½®** (`tradeiq/asgi.py`)ï¼š
```python
ProtocolTypeRouter({
    "http": django_asgi_app,
    "websocket": AuthMiddlewareStack(
        URLRouter(websocket_urlpatterns)  # ws/chat/
    )
})
```

**ChatConsumer** (`chat/consumers.py`)ï¼š
- è¿æ¥è·¯å¾„ï¼š`ws://localhost:8000/ws/chat/?user_id=uuid`
- åŠ å…¥é¢‘é“ç»„ï¼š`chat_user_{user_id}`
- æ¥æ”¶æ¶ˆæ¯æ ¼å¼ï¼š`{"message": "...", "agent_type": "auto", "user_id": "..."}`
- å›å¤æ¶ˆæ¯æ ¼å¼ï¼š`{"type": "reply", "message": "...", "agent_type": "...", "tools_used": [...]}`
- è‡ªåŠ¨æ£€æµ‹ Agent ç±»å‹ï¼š
  - åŒ…å« "pattern"/"behavior"/"revenge" â†’ è¡Œä¸ºåˆ†æ Agent
  - åŒ…å« "post"/"bluesky"/"content" â†’ å†…å®¹ç”Ÿæˆ Agent
  - å…¶ä»– â†’ å¸‚åœºåˆ†æ Agent
- å¤„ç†ä¸­å‘é€ "thinking" çŠ¶æ€æŒ‡ç¤º

### 7.2 å‰ç«¯ WebSocket (`src/lib/websocket.ts`)

**TradeIQWebSocket ç±»**ï¼š
```typescript
connect()          // å»ºç«‹è¿æ¥
disconnect()       // æ–­å¼€è¿æ¥
send(message)      // å‘é€ JSON æ¶ˆæ¯
sendMessage(content)  // å‘é€èŠå¤©æ¶ˆæ¯
onMessage(handler)    // è®¢é˜…æ¶ˆæ¯
onStatusChange(handler)  // è®¢é˜…çŠ¶æ€å˜åŒ–
getStatus()        // è·å–å½“å‰çŠ¶æ€
```

**ç‰¹æ€§**ï¼š
- æŒ‡æ•°é€€é¿é‡è¿ï¼ˆæœ€å¤š 5 æ¬¡ï¼‰
- æ¶ˆæ¯å¤„ç†å™¨æ¨¡å¼ï¼ˆæ”¯æŒæ¸…ç†ï¼‰
- è¿æ¥çŠ¶æ€ï¼š`connecting` | `connected` | `disconnected` | `error`

### 7.3 è¡Œä¸ºæé†’æ¨é€

å½“ç”¨æˆ·åˆ›å»ºäº¤æ˜“è§¦å‘è¡Œä¸ºæ£€æµ‹åï¼Œæé†’æ¶ˆæ¯é€šè¿‡ WebSocket Channel Group å¼‚æ­¥æ¨é€åˆ°èŠå¤©é¢æ¿ï¼Œå®ç°"äº¤æ˜“æ—¶å®æ—¶æ•™ç»ƒ"æ•ˆæœã€‚

---

## 8. è®¤è¯ä¸å®‰å…¨

### 8.1 Supabase JWT è®¤è¯

**ä¸­é—´ä»¶** (`tradeiq/middleware/supabase_auth.py`)ï¼š
1. ä»è¯·æ±‚å¤´æå– `Authorization: Bearer <token>`
2. ä½¿ç”¨ `SUPABASE_JWT_SECRET` éªŒè¯ JWT ç­¾å
3. ä» claims ä¸­æå–ç”¨æˆ·é‚®ç®±

**ç”¨æˆ·æ˜ å°„** (`tradeiq/auth_utils.py`)ï¼š
```python
get_or_create_user_from_jwt(jwt_claims)
# åŸå­äº‹åŠ¡æ“ä½œï¼Œé˜²ç«æ€æ¡ä»¶
# Supabase Auth â†’ UserProfile (é€šè¿‡é‚®ç®±å…³è”)
```

### 8.2 æƒé™ç±»

- `IsAuthenticated` â€” éœ€è¦è®¤è¯
- `IsAuthenticatedOrReadOnly` â€” è¯»å¼€æ”¾ï¼Œå†™éœ€è®¤è¯
- `IsOwnerOrReadOnly` â€” ä»…æ‰€æœ‰è€…å¯ä¿®æ”¹

### 8.3 CORS é…ç½®

- å…è®¸æ¥æºï¼š`localhost:3000`ï¼ˆå¼€å‘æ¨¡å¼å…è®¸æ‰€æœ‰æ¥æºï¼‰
- å…è®¸å‡­è¯ï¼šæ˜¯
- å…è®¸å¤´ï¼šå…¨éƒ¨

---

## 9. æ¼”ç¤ºç³»ç»Ÿ

### 9.1 è®¾è®¡ç†å¿µ

é¡¹ç›®åŒ…å«å®Œæ•´çš„æ¼”ç¤ºåœºæ™¯ç®¡ç†ç³»ç»Ÿï¼Œä¸“ä¸º Hackathon ç°åœºæ¼”ç¤ºè®¾è®¡ã€‚

### 9.2 æ¼”ç¤ºåœºæ™¯

| åœºæ™¯ | è§¦å‘æ¨¡å¼ | é¢„æœŸæ£€æµ‹ |
|------|---------|---------|
| revenge_trading | äºæŸå 10 åˆ†é’Ÿå†… 5 ç¬”äº¤æ˜“ | æŠ¥å¤æ€§äº¤æ˜“ |
| overtrading | æ—¥å†… 25 ç¬”ï¼ˆå‡å€¼ 8 ç¬”ï¼‰ | è¿‡åº¦äº¤æ˜“ |
| loss_chasing | 4 è¿äº + 1.5x åŠ ä»“ | è¿½æŸäº¤æ˜“ |
| healthy_session | 6 ç¬”ï¼Œ60% èƒœç‡ | æ— å¼‚å¸¸ï¼ˆå¥åº·ï¼‰ |

### 9.3 æ¼”ç¤ºç«¯ç‚¹

| ç«¯ç‚¹ | åŠŸèƒ½ |
|------|------|
| `POST /api/demo/seed/` | åˆ›å»ºæ¼”ç¤ºç”¨æˆ· + åŠ è½½é»˜è®¤åœºæ™¯ |
| `POST /api/demo/load-scenario/` | åŠ è½½æŒ‡å®šåœºæ™¯çš„äº¤æ˜“æ•°æ® |
| `POST /api/demo/analyze/` | åŠ è½½åœºæ™¯ + è¡Œä¸ºåˆ†æ + AI æé†’ï¼ˆä¸€æ­¥å®Œæˆï¼‰ |
| `GET /api/demo/scenarios/` | åˆ—å‡ºå¯ç”¨åœºæ™¯ |
| `POST /api/demo/wow-moment/` | **ä¸‰æŸ±æ¼”ç¤º**ï¼šå¸‚åœºåˆ†æ + è¡Œä¸ºæ´å¯Ÿ + å†…å®¹é¢„è§ˆ |

### 9.4 "WOW Moment" æ¼”ç¤ºæµç¨‹

è¿™æ˜¯æœ€æ ¸å¿ƒçš„æ¼”ç¤ºç«¯ç‚¹ï¼Œä¸€æ¬¡è°ƒç”¨å±•ç¤ºä¸‰å¤§æ”¯æŸ±ååŒï¼š

```
è¾“å…¥ï¼šinstrumentï¼ˆå¦‚ frxEURUSDï¼‰+ user_id
 â†“
1. å¸‚åœºåˆ†æï¼šè·å–è¯¥å“ç§å®æ—¶è¡Œæƒ… + æƒ…ç»ªåˆ†æ
2. è¡Œä¸ºæ´å¯Ÿï¼šåˆ†æç”¨æˆ·æœ€è¿‘äº¤æ˜“æ¨¡å¼ï¼Œç”Ÿæˆæ•™ç»ƒå»ºè®®
3. å†…å®¹é¢„è§ˆï¼šåŸºäºåˆ†æç»“æœï¼Œç”Ÿæˆ Bluesky å¸–å­è‰ç¨¿
 â†“
è¾“å‡ºï¼š{market_analysis, behavioral_insight, content_preview}
```

**æ¼”ç¤ºç”¨æˆ· ID**ï¼š`d1000000-0000-0000-0000-000000000001`

---

## 10. æ•°æ®æµå…¨é“¾è·¯

### 10.1 å¸‚åœºåˆ†æé“¾è·¯

```
Deriv WebSocket â†’ fetch_price_data() â†’ Router
                                         â†“
NewsAPI + Finnhub â†’ search_news() â†’ DeepSeek (Function Calling)
                                         â†“
                     analyze_technicals() â†’ LLM ç»¼åˆåˆ†æ
                                         â†“
                     get_sentiment() â†’ åˆè§„è¿‡æ»¤ â†’ ç”¨æˆ·
```

### 10.2 è¡Œä¸ºæ•™ç»ƒé“¾è·¯

```
ç”¨æˆ·åˆ›å»ºäº¤æ˜“ â†’ POST /api/behavior/trades/
              â†“
         TradeViewSet.create()
              â†“
         analyze_trade_patterns() (24h å›æº¯)
              â†“
    â”Œâ”€ detect_revenge_trading()
    â”œâ”€ detect_overtrading()
    â”œâ”€ detect_loss_chasing()
    â””â”€ detect_time_patterns()
              â†“
         if pattern_detected:
              â†“
         generate_behavioral_nudge_with_ai()
              â†“
    â”Œâ”€ WebSocket â†’ èŠå¤©é¢æ¿å®æ—¶æ¨é€
    â””â”€ save_behavioral_metric() â†’ æ•°æ®åº“å­˜å‚¨
```

### 10.3 å†…å®¹ç”Ÿæˆé“¾è·¯

```
ç”¨æˆ·è¾“å…¥æ´å¯Ÿ + é€‰æ‹©äººæ ¼/å¹³å°
         â†“
    POST /api/content/generate/
         â†“
    load_persona_prompt()
         â†“
    DeepSeek (äººæ ¼åŒ–ç”Ÿæˆ)
         â†“
    compliance_check() â†’ åˆè§„è¿‡æ»¤
         â†“
    format_for_platform() â†’ å­—æ•°é€‚é…
         â†“
    è¿”å›è‰ç¨¿ â†’ ç”¨æˆ·é¢„è§ˆ
         â†“
    POST /api/content/publish-bluesky/ (å¯é€‰)
         â†“
    atproto â†’ Bluesky å‘å¸ƒ â†’ è¿”å›å¸–å­ URL
```

### 10.4 Agent ç®¡é“é“¾è·¯

```
POST /api/agents/pipeline/
         â†“
    Stage 1: Market Monitor
    - æ£€æµ‹æ³¢åŠ¨äº‹ä»¶ï¼ˆå¦‚ EUR/USD +2.5%ï¼‰
         â†“
    Stage 2: Analyst
    - åˆ†ææ ¹å› ï¼ˆæ–°é—» + æƒ…ç»ª + æŠ€æœ¯é¢ï¼‰
         â†“
    Stage 3: Portfolio Advisor
    - ç»“åˆç”¨æˆ·æŒä»“ï¼Œä¸ªæ€§åŒ–å»ºè®®
         â†“
    Stage 4: Content Creator
    - ç”Ÿæˆ Bluesky å¸–å­ï¼ˆâ‰¤300 å­—ç¬¦ï¼‰
         â†“
    è¿”å› PipelineResultï¼ˆ4 ä¸ªé˜¶æ®µå…¨éƒ¨è¾“å‡ºï¼‰
```

---

## 11. ç›®å½•ç»“æ„é€ŸæŸ¥

```
deriv hackathon/
â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡ï¼ˆå«çœŸå®å¯†é’¥ï¼‰
â”œâ”€â”€ .gitignore                    # Git å¿½ç•¥è§„åˆ™ï¼ˆ349 è¡Œï¼‰
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
â”‚
â”œâ”€â”€ backend/                      # Django åç«¯
â”‚   â”œâ”€â”€ tradeiq/                  # ä¸»é…ç½®ï¼ˆsettings, urls, asgi, authï¼‰
â”‚   â”œâ”€â”€ agents/                   # AI Agentï¼ˆrouter, llm_client, tools, pipelineï¼‰
â”‚   â”œâ”€â”€ market/                   # å¸‚åœºï¼ˆmodels, tools, viewsï¼‰
â”‚   â”œâ”€â”€ behavior/                 # è¡Œä¸ºï¼ˆmodels, detection, tools, viewsï¼‰
â”‚   â”œâ”€â”€ content/                  # å†…å®¹ï¼ˆmodels, tools, bluesky, viewsï¼‰
â”‚   â”œâ”€â”€ chat/                     # WebSocketï¼ˆconsumersï¼‰
â”‚   â”œâ”€â”€ demo/                     # æ¼”ç¤ºï¼ˆviews, scenariosï¼‰
â”‚   â”œâ”€â”€ fixtures/                 # æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ requirements.txt          # Python ä¾èµ–
â”‚   â””â”€â”€ manage.py
â”‚
â”œâ”€â”€ frontend/                     # Next.js å‰ç«¯
â”‚   â”œâ”€â”€ src/app/                  # é¡µé¢è·¯ç”±ï¼ˆ5 ä¸ªä¸»é¡µé¢ï¼‰
â”‚   â”œâ”€â”€ src/components/           # ç»„ä»¶ï¼ˆ25+ ä¸ªï¼‰
â”‚   â”œâ”€â”€ src/hooks/                # è‡ªå®šä¹‰ Hooksï¼ˆ10+ ä¸ªï¼‰
â”‚   â”œâ”€â”€ src/lib/                  # API å®¢æˆ·ç«¯ + WebSocket
â”‚   â””â”€â”€ package.json              # Node ä¾èµ–
â”‚
â”œâ”€â”€ scripts/                      # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ setup_env.sh              # ç¯å¢ƒå®‰è£…
â”‚   â”œâ”€â”€ start_backend.sh          # å¯åŠ¨åç«¯
â”‚   â”œâ”€â”€ start_frontend.sh         # å¯åŠ¨å‰ç«¯
â”‚   â”œâ”€â”€ verify_env.py             # ç¯å¢ƒæ£€æµ‹
â”‚   â””â”€â”€ environment.yml           # Conda ç¯å¢ƒå®šä¹‰
â”‚
â””â”€â”€ dev/                          # å¼€å‘èµ„æº
    â”œâ”€â”€ diagrams/                 # 10 å¼ æ¶æ„å›¾ï¼ˆPNGï¼‰
    â”œâ”€â”€ docs/                     # è®¾è®¡æ–‡æ¡£ + å®æ–½è®¡åˆ’
    â””â”€â”€ tests/                    # æµ‹è¯•è„šæœ¬
```

---

## 12. API æ¥å£æ¸…å•

### å¸‚åœºåˆ†æ (`/api/market/`)

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/market/ask/` | AI åˆ†æå¸ˆé—®ç­” |
| POST | `/api/market/brief/` | å¸‚åœºç®€æŠ¥ |
| POST | `/api/market/price/` | å®æ—¶è¡Œæƒ… |
| POST | `/api/market/history/` | K çº¿å†å² |
| POST | `/api/market/technicals/` | æŠ€æœ¯æŒ‡æ ‡ |
| POST | `/api/market/sentiment/` | æƒ…ç»ªåˆ†æ |

### è¡Œä¸ºæ•™ç»ƒ (`/api/behavior/`)

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET/POST | `/api/behavior/trades/` | äº¤æ˜“åˆ—è¡¨/åˆ›å»º |
| POST | `/api/behavior/trades/analyze_batch/` | æ‰¹é‡åˆ†æ |
| POST | `/api/behavior/trades/load_demo_scenario/` | åŠ è½½æ¼”ç¤ºåœºæ™¯ |
| GET | `/api/behavior/profiles/{id}/statistics/` | ç”¨æˆ·ç»Ÿè®¡ |
| GET | `/api/behavior/metrics/summary/` | è¡Œä¸ºæ‘˜è¦ |
| POST | `/api/behavior/metrics/create_demo_user/` | åˆ›å»ºæ¼”ç¤ºç”¨æˆ· |

### å†…å®¹å¼•æ“ (`/api/content/`)

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/content/generate/` | ç”Ÿæˆå†…å®¹ |
| POST | `/api/content/publish-bluesky/` | å‘å¸ƒåˆ° Bluesky |
| GET | `/api/content/personas/` | äººæ ¼åˆ—è¡¨ |
| GET/POST | `/api/content/posts/` | å¸–å­ CRUD |

### AI Agent (`/api/agents/`)

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/agents/query/` | å• Agent æŸ¥è¯¢ |
| POST | `/api/agents/chat/` | è‡ªåŠ¨è·¯ç”±èŠå¤© |
| POST | `/api/agents/pipeline/` | å®Œæ•´ 4 é˜¶æ®µç®¡é“ |
| POST | `/api/agents/monitor/` | å¸‚åœºç›‘æ§ï¼ˆç¬¬ 1 é˜¶æ®µï¼‰ |
| POST | `/api/agents/analyst/` | å¸‚åœºåˆ†æï¼ˆç¬¬ 2 é˜¶æ®µï¼‰ |
| POST | `/api/agents/advisor/` | æŠ•èµ„é¡¾é—®ï¼ˆç¬¬ 3 é˜¶æ®µï¼‰ |
| POST | `/api/agents/content-gen/` | å†…å®¹åˆ›ä½œï¼ˆç¬¬ 4 é˜¶æ®µï¼‰ |

### æ¼”ç¤º (`/api/demo/`)

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/demo/seed/` | åˆå§‹åŒ–æ¼”ç¤ºæ•°æ® |
| GET | `/api/demo/scenarios/` | åœºæ™¯åˆ—è¡¨ |
| POST | `/api/demo/load-scenario/` | åŠ è½½åœºæ™¯ |
| POST | `/api/demo/analyze/` | åœºæ™¯åˆ†æ |
| POST | `/api/demo/wow-moment/` | ä¸‰æŸ±è”åˆæ¼”ç¤º |

### WebSocket

| åè®® | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| WS | `ws://localhost:8000/ws/chat/` | AI èŠå¤© + è¡Œä¸ºæé†’æ¨é€ |

---

## 13. ç¯å¢ƒå˜é‡æ¸…å•

```bash
# Django æ ¸å¿ƒ
DJANGO_SECRET_KEY=...
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# æ•°æ®åº“
DATABASE_URL=postgresql://postgres:password@host:5432/postgres

# Supabase
SUPABASE_JWT_SECRET=...
SUPABASE_URL=https://xxx.supabase.co

# LLM (äºŒé€‰ä¸€)
DEEPSEEK_API_KEY=...         # DeepSeek ç›´è¿
OPENROUTER_API_KEY=...       # OpenRouterï¼ˆå½“å‰ä¸»ç”¨ï¼‰

# æ–°é—»æ•°æ®
NEWS_API_KEY=...
FINNHUB_API_KEY=...

# Deriv
DERIV_APP_ID=125489

# Bluesky
BLUESKY_HANDLE=xxx.bsky.social
BLUESKY_APP_PASSWORD=xxxx-xxxx-xxxx-xxxx

# Google OAuthï¼ˆå¯é€‰ï¼‰
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_SECRET=...
CALLBACK_URL=...

# å‰ç«¯
NEXT_PUBLIC_API_URL=http://localhost:8000/api
NEXT_PUBLIC_WS_URL=ws://localhost:8000/ws
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=...
NEXT_PUBLIC_AUTH_CALLBACK_URL=http://localhost:3000/auth/callback
```

### 13.1 Google ç™»å½• `redirect_uri_mismatch` ä¿®å¤è¦ç‚¹

è‹¥å‡ºç° `Error 400: redirect_uri_mismatch`ï¼Œéœ€è¦åœ¨ Google Cloud Console çš„ OAuth Client ä¸­æ·»åŠ **ç²¾ç¡®**å›è°ƒåœ°å€ï¼š

```text
https://<your-project-ref>.supabase.co/auth/v1/callback
```

å…¶ä¸­ `<your-project-ref>` å¿…é¡»ä¸ `NEXT_PUBLIC_SUPABASE_URL` å¯¹åº”ï¼ˆå¦‚ `https://abc.supabase.co` åˆ™å›è°ƒä¸º `https://abc.supabase.co/auth/v1/callback`ï¼‰ã€‚

åŒæ—¶éœ€åœ¨ Supabase Auth URL é…ç½®ä¸­å…è®¸å‰ç«¯å›è·³åœ°å€ï¼ˆå¦‚ `http://localhost:3000/auth/callback`ï¼‰ã€‚

---

## 14. ç°æœ‰ä¸è¶³ä¸æ”¹è¿›æ–¹å‘

### 14.1 è®¾è®¡ vs å®ç°å·®å¼‚

| é¡¹ç›® | è®¾è®¡æ–‡æ¡£ | å®é™…å®ç° |
|------|---------|---------|
| åç«¯æ¡†æ¶ | FastAPI + LangGraph | Django + åŸç”Ÿå‡½æ•°è°ƒç”¨ |
| AI å¼•æ“ | Claude API | DeepSeek (via OpenRouter) |
| UI ç»„ä»¶åº“ | shadcn/ui | çº¯ Tailwind æ‰‹å†™ç»„ä»¶ |
| å›¾è¡¨åº“ | TradingView Lightweight Charts | Rechartsï¼ˆlightweight-charts å·²è£…æœªç”¨ï¼‰ |
| ç¼“å­˜ | Upstash Redis | InMemory Channel Layer |
| éƒ¨ç½² | Vercel + Railway | æœ¬åœ°å¼€å‘ï¼ˆæœªéƒ¨ç½²ï¼‰ |

### 14.2 æ¶æ„å±‚é¢

- **æ—  Docker é…ç½®**ï¼šç¼ºå°‘å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ
- **æ—  CI/CD**ï¼šç¼ºå°‘è‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²æµæ°´çº¿
- **Channel Layer**ï¼šä½¿ç”¨ InMemoryChannelLayerï¼Œä¸æ”¯æŒå¤šè¿›ç¨‹
- **æ— çŠ¶æ€ç®¡ç†**ï¼šå‰ç«¯æ— å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆReact Context / Zustandï¼‰
- **æ— å•å…ƒæµ‹è¯•**ï¼š`tests/` ç›®å½•å­˜åœ¨ä½†æµ‹è¯•ç”¨ä¾‹ä¸å®Œå–„

### 14.3 å®‰å…¨å±‚é¢

- `.env` åŒ…å«çœŸå®å¯†é’¥ï¼Œéœ€ç¡®ä¿ä¸è¢«æäº¤åˆ°å…¬å¼€ä»“åº“
- JWT è®¤è¯æµç¨‹å·²å®ç°ä½†å‰ç«¯é›†æˆä¸å®Œæ•´
- CORS åœ¨è°ƒè¯•æ¨¡å¼å…è®¸æ‰€æœ‰æ¥æº

### 14.4 å¯ä¼˜åŒ–æ–¹å‘

- **TradingView Charts**ï¼šå·²å®‰è£… `lightweight-charts`ï¼Œå¯æ›¿æ¢ Recharts è·å¾—æ›´ä¸“ä¸šçš„é‡‘èå›¾è¡¨ä½“éªŒ
- **Redis Channel Layer**ï¼šéƒ¨ç½²æ—¶åº”åˆ‡æ¢åˆ° Redisï¼Œæ”¯æŒå¤šè¿›ç¨‹ WebSocket
- **æµå¼å“åº”**ï¼šAI å›å¤å¯ä½¿ç”¨ SSE/Stream å®ç°æ‰“å­—æœºæ•ˆæœ
- **ç¦»çº¿ç¼“å­˜**ï¼šåˆ©ç”¨ `useApiWithFallback` çš„å›é€€æœºåˆ¶ï¼Œå¯æ‰©å±•ä¸º Service Worker ç¼“å­˜
- **å›½é™…åŒ–**ï¼šå½“å‰ä»…è‹±æ–‡ï¼Œå¯å¢åŠ å¤šè¯­è¨€æ”¯æŒ

---

> ğŸ“ **æ–‡æ¡£ç”Ÿæˆæ—¶é—´**ï¼š2026-02-08
> ğŸ“¦ **é¡¹ç›®ç‰ˆæœ¬**ï¼šåŸºäº commit `6e40c59` åˆ†æ
> ğŸ” **åˆ†æèŒƒå›´**ï¼šå…¨éƒ¨åç«¯ Python æºæ–‡ä»¶ + å…¨éƒ¨å‰ç«¯ TypeScript æºæ–‡ä»¶ + é…ç½®æ–‡ä»¶ + è„šæœ¬
